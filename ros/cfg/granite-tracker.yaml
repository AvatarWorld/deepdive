# TRACKING PARAMETERS
#
# The tracking code is soleley responsible for estimating the transform
# between the world and body frame. To do this it requires a number of
# static transforms -- notably the world -> lighthouse transform and the
# tracker -> body transforms that are broadcast by the calibtation code.

# Covariance matrix is written to this file and reloaded in future
# to improve filter convergence time.
cfgfile: "tracking.cov"

# The trackers rigidly attached to the body being tracked. This code
# expects <serial>/imu, <serial>/light and <serial>/body frames to
# be broadcast by the calibration node for each of these trackers.
trackers:
  - "LHR-08DDBC05"
  - "LHR-08DE340B"

# This filter relates these two frames
frames:
  parent:         "world"               # Inertial parent frame (TF2)
  child:          "body"                # Child frame (TF2)

# Topics for publishing data
topics:
  pose:           "/loc/truth/pose"     # Topic for publishing pose
  twist:          "/loc/truth/twist"    # Topic for publishing twist

# Gravity vector in parent frame
gravity:          [0.0, 0.0, -9.80665]

# Fixed tracking rate of filter
rate:             62.5

# Run-to-run bias correcting using parameters from vive
correct:
  light:          true                 # Correct light measurements
  imu:            true                 # Correct IMU measurements

# What meaasurements to use to correct the state estimate
use:
  light:          true                  # Use light measurements updates
  imu:            true                  # Use light measurements updates

# Thresholds used to reject noisy light measurements
thresholds:
  angle:          60.0                  # In degrees
  duration:       1.0                   # In microseconds

# Initial state value
initial_estimate:
  position:       [0, 0, 0]             # Initial pose (world frame)
  attitude:       [0, 0, 0, 1]          # Attitude quaternion (body -> world)
  velocity:       [0, 0, 0]             # Initial velocity (world frame)
  angvel:         [0, 0, 0]             # Initial angular velocity (world frame)
  acceleration:   [0, 0, 0]             # Initial acceleration (world frame)
  gyro_bias:      [0, 0, 0]             # Initial biase (gyro frame)

# Values the covariance in state estimate is initialized to
initial_covariance:
  position:       [10, 10, 10]
  attitude:       [10, 10, 10]
  velocity:       [1.0e-03, 1.0e-03, 1.0e-03]
  angvel:         [1.0e-03, 1.0e-03, 1.0e-03]
  acceleration:   [1.0e-03, 1.0e-03, 1.0e-03]
  gyro_bias:      [1.0e-01, 1.0e-01, 1.0e-01]

# Process noise that is added when the filter is updated
process_noise:
  position:       [1.0e-08, 1.0e-08, 1.0e-08]
  attitude:       [1.0e-08, 1.0e-08, 1.0e-08]
  velocity:       [1.0e-06, 1.0e-06, 1.0e-06]
  angvel:         [1.0e-06, 1.0e-06, 1.0e-06]
  acceleration:   [1.0e-10, 1.0e-10, 1.0e-10]
  gyro_bias:      [2.4e-10, 2.4e-10, 2.4e-10]